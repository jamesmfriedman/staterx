{"version":3,"sources":["../../../lib/dist/utils.js","../../../lib/dist/create-staterx.js","../../../lib/dist/create-object.js","../../../lib/dist/react.js","../../../lib/dist/create-value.js","state.tsx","game-canvas.tsx","game-html.tsx","app.tsx","serviceWorker.ts","index.tsx"],"names":["wrapDispatchSubject","dispatch$","action","next","getType","type","split","join","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__spreadArrays","il","r","Array","k","a","j","jl","DEFAULT_CONSTANTS","createStateRx","initialState","options","overrides","_a","_b","name","Math","random","toString","substring","_c","autoRun","_d","reducer","userReducer","state","state$","constants","createReducer","createActions","createSelectors","constant","reduce","acc","createConstant","createConstants","get","getValue","_e","Subject","_dispatchers$","action$","merge","pipe","mergeMap","obs$","dispatch","set","data","SET","reset","RESET","createBaseActions","baseActions","actions","selectors","res","createBaseReducer","_reducer$","map","distinctUntilChanged","run","subscribe","api","clone","newInitialState","BehaviorSubject","effects","MERGE","createObject","useRx","obsInput$","deps","useMemo","useState","undefined","value","setValue","useLayoutEffect","sub","err","unsubscribe","getDeflectionAngle","r1","r2","dir","max","y","height","min","getRandomFloat","getRandomBool","loop$","interval","keyDown$","fromEvent","document","keyUp$","windowResize$","window","debounceTime","speed","increase","val","board","width","innerWidth","innerHeight","ball","x","dirX","dirY","serve","tick","b","currSpeed","p1State","p1","p2State","p2","ballState","boardWidth","boardHeight","newY","newBounds","scorePoint","player","moveDir","score","score$","distinctUntilKeyChanged","moveUp","moveDown","stopMove","Canvas","ref","useRef","useEffect","canvas","current","ctx","getContext","drawPlayer","fillRect","boardState","clearRect","fillStyle","half","centerX","centerY","radius","beginPath","arc","PI","fill","drawBall","className","Score","Game","Paddle","style","transform","Ball","App","renderer","setRenderer","loopSub","tap","keySub","evt","which","keycode","includes","switchMap","windowSub","initGame","zIndex","position","onClick","Boolean","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"gRAqBWA,G,MAAsB,SAAUC,GAAa,OAAO,SAAUC,GAErE,OADAD,EAAUE,KAAKD,GACRA,KAEAE,EAAU,SAAUF,GAC3B,OAAOA,EAAOG,KAAKC,MAAM,IAAK,GAAGC,KAAK,M,QC1BtCC,EAAsC,WAStC,OARAA,EAAWC,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KACzDN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,IAEKU,MAAMC,KAAMP,YAE5BQ,EAAkC,SAAUX,EAAGY,GAC/C,IAAIb,EAAI,GACR,IAAK,IAAIM,KAAKL,EAAOH,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,IAAMO,EAAEC,QAAQR,GAAK,IAC9EN,EAAEM,GAAKL,EAAEK,IACb,GAAS,MAALL,GAAqD,oBAAjCH,OAAOiB,sBACtB,KAAIb,EAAI,EAAb,IAAgBI,EAAIR,OAAOiB,sBAAsBd,GAAIC,EAAII,EAAED,OAAQH,IAC3DW,EAAEC,QAAQR,EAAEJ,IAAM,GAAKJ,OAAOS,UAAUS,qBAAqBP,KAAKR,EAAGK,EAAEJ,MACvEF,EAAEM,EAAEJ,IAAMD,EAAEK,EAAEJ,KAE1B,OAAOF,GAEPiB,EAAkD,WAClD,IAAK,IAAIhB,EAAI,EAAGC,EAAI,EAAGgB,EAAKd,UAAUC,OAAQH,EAAIgB,EAAIhB,IAAKD,GAAKG,UAAUF,GAAGG,OACxE,IAAIc,EAAIC,MAAMnB,GAAIoB,EAAI,EAA3B,IAA8BnB,EAAI,EAAGA,EAAIgB,EAAIhB,IACzC,IAAK,IAAIoB,EAAIlB,UAAUF,GAAIqB,EAAI,EAAGC,EAAKF,EAAEjB,OAAQkB,EAAIC,EAAID,IAAKF,IAC1DF,EAAEE,GAAKC,EAAEC,GACjB,OAAOJ,GAKPM,EAAoB,CAAC,MAAO,SAoCrBC,EAAgB,SAAhBA,EAA0BC,EAAcC,EAASC,GACxD,IAAIC,EACAC,EAAKH,EAAQI,KAAMA,OAAc,IAAPD,EDrEvBE,KAAKC,SAASC,SAAS,IAAIC,UAAU,EAAG,ICqEmBL,EAAIM,EAAKT,EAAQU,QAASA,OAAiB,IAAPD,GAAuBA,EAAIE,EAAKX,EAAQY,QAASC,OAAqB,IAAPF,EAAgB,SAAUG,GAAS,OAAOA,GAAWH,EACtNI,EAASd,EAAUc,OAAQC,EAAYf,EAAUe,UAAWC,EAAgBhB,EAAUgB,cAAeC,EAAgBjB,EAAUiB,cAAeC,EAAkBlB,EAAUkB,gBAC1KC,EDzDqB,SAAUhB,EAAMY,GACzC,OAAOA,EAAUK,QAAO,SAAUC,EAAKF,GAEnC,OADAE,EAAIF,GALgB,SAAUhB,EAAMgB,GACxC,OAAOhB,EAAO,IAAMgB,EAIAG,CAAenB,EAAMgB,GAC9BE,IACR,ICqDYE,CAAgBpB,EAAMf,EAAeQ,EAAmBmB,IACnES,EAAM,WAAc,OAAOV,EAAOW,YAClCC,EAzCgB,SAAUzB,GAC9B,IAAIkB,EAAWlB,EAAGkB,SAAUK,EAAMvB,EAAGuB,IACjC/D,EAAY,IAAIkE,IAChBC,EAAgB,IAAID,IACpBE,EAAUC,YAAMrE,EAAWmE,EAAcG,KAAKC,aAAS,SAAUC,GAAQ,OAAOA,OAChFC,EAAW1E,EAAoBC,GACnC,MAAO,CACHoE,QAASA,EACTM,IAAK,SAAUC,GAGX,OADAA,EAAuB,oBAATA,EAAsBA,EAAKZ,KAASY,EAC3CF,EAAS,CAAErE,KAAMsD,EAASkB,IAAKD,KAAMA,KAEhDE,MAAO,WAAc,OAAOJ,EAAS,CAAErE,KAAMsD,EAASoB,SACtDL,SAAUA,EACVN,cAAeA,GA0BVY,CAAkB,CACvBrB,SAAUA,EACVK,IAAKA,IACLK,EAAUH,EAAGG,QAASK,EAAWR,EAAGQ,SAAUO,EAAc1D,EAAO2C,EAAI,CAAC,UAAW,aACnFgB,EAAU3D,EAAOkC,EAAc,CAC/BE,SAAUA,EACVK,IAAKA,EACLU,SAAUA,IACV,IACAS,EAAgC,OAApBzB,QAAgD,IAApBA,OAA6B,EAASA,EAAgBJ,GAC9FH,EAjCgB,SAAUV,GAC9B,IAAIH,EAAeG,EAAGH,aAAcqB,EAAWlB,EAAGkB,SAAUR,EAAUV,EAAGU,QAASC,EAAcX,EAAGW,YACnG,OAAO,SAAUC,EAAOnD,GAEpB,OADWA,EAAOG,KAAKC,MAAM,IAAK,GAAGC,KAAK,MAEtC,KAAKoD,EAASkB,IACV,OAAO3E,EAAO0E,KAClB,KAAKjB,EAASoB,MACV,OAAOzC,EACX,QACI,IAAI8C,EAAMjC,EAAQE,EAAOnD,GAGzB,OAAOkF,IAAQ/B,EAAQD,EAAYC,EAAOnD,GAAUkF,IAoBlDC,CAAkB,CAC5B1B,SAAUA,EACVrB,aAAcA,EACda,QAASK,EAAc,CACnBG,SAAUA,IAEdP,YAAaA,IAMbkC,EAAYjB,EAAQE,KAAKgB,aAAI,SAAUrF,GAAU,OAAOiD,EAAQG,EAAOW,WAAY/D,MAAasF,eAChGC,EAAM,WAAc,OAAOH,EAAUI,UAAUpC,IAC/CqC,EAAMnF,EAASA,EAASA,EAASA,EAAS,GAAI0E,GAAUC,GAAYF,GAAc,CAAEtC,KAAMA,EAC1FW,OAAQA,EACRe,QAASA,EACTV,SAAUA,EACV8B,IAAKA,EACLzB,IAAKA,EACL4B,MAZQ,SAAUC,GAElB,YADwB,IAApBA,IAA8BA,EAAkB7B,KAC7C3B,EAAcwD,EAAiBtD,EAAS/B,EAASA,EAAS,GAAIgC,GAAY,CAAEc,OAAQ,IAAIwC,IAAgBD,OAW/GnB,SAAUA,EACVY,UAAWA,IACXS,EAAqC,QAA1BtD,EAAKF,EAAQwD,eAA4B,IAAPtD,OAAgB,EAASA,EAAGrB,KAAKmB,EAASoD,GAE3F,OADA1C,GAAWwC,IACJjF,EAASA,EAAS,GAAImF,GAAMI,IC7GnCvF,EAAsC,WAStC,OARAA,EAAWC,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KACzDN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,IAEKU,MAAMC,KAAMP,YAK5B0C,EAAgB,SAAUhB,GAC1B,IAAIkB,EAAWlB,EAAGkB,SAAUe,EAAWjC,EAAGiC,SAC1C,MAAO,CACHJ,MAAO,SAAUM,GAAQ,OAAOF,EAAS,CAAErE,KAAMsD,EAASqC,MAAOpB,KAAMA,OAG3EpB,EAAgB,SAAUf,GAC1B,IAAIkB,EAAWlB,EAAGkB,SAClB,OAAO,SAAUN,EAAOnD,GAEpB,OADWE,EAAQF,IAEf,KAAKyD,EAASqC,MACV,OAAOxF,EAASA,EAAS,GAAI6C,GAAQnD,EAAO0E,MAChD,QACI,OAAOvB,KAIZ4C,EAAe,SAAU3D,EAAcC,GAE9C,YADgB,IAAZA,IAAsBA,EAAU,IAC7BF,EAAcC,EAAcC,EAAS,CACxCe,OAAQ,IAAIwC,IAAgBxD,GAC5BiB,UAAW,CAAC,SACZE,cAAeA,EACfD,cAAeA,KCrChB,SAAS0C,EAAMC,EAAWC,GAC7B,IAAI3B,EAAO4B,mBAAQ,WAAc,MAA6B,oBAAdF,EAA2BA,IAAcA,IAAeC,GACpG3D,EAAK6D,mBAET,aAAc7B,EAAOA,EAAKR,gBAAasC,GAAYC,EAAQ/D,EAAG,GAAIgE,EAAWhE,EAAG,GAYhF,OAVAiE,2BAAgB,WACZ,IAAIC,EAAMlC,EAAKiB,UAAUe,GAAU,SAAUG,GACzCH,GAAS,WACL,MAAMG,QAGd,OAAO,WACHD,EAAIE,iBAET,CAACpC,IACG+B,E,ICfwBlE,EAAcC,E,gEC8B3CuE,EAAqB,SAACC,EAAUC,GACpC,IACMC,EAD8D,EAAvDrE,KAAKsE,IAAI,EAAGF,EAAGG,EAAIJ,EAAGI,EAAIH,EAAGI,OAASJ,EAAGI,OAAS,GAC5CL,EAAGK,OAAS,EAC/B,OAAOxE,KAAKsE,KAAK,EAAGtE,KAAKyE,IAAI,EAAGJ,KAG5BK,EAAiB,SAACD,EAAaH,GAAd,OACrBtE,KAAKC,UAAYqE,EAAMG,GAAOA,GAE1BE,EAAgB,kBAAM3E,KAAKC,UAAY,IAKvC2E,EAAQC,YAAU,EA3BZ,GA2BuB,KAC7BC,EAAWC,YAAyBC,SAAU,WAC9CC,EAASF,YAAyBC,SAAU,SAC5CE,EAAgBH,YAAUI,OAAQ,UAAUxD,KAAKyD,YAAa,MAK9DC,QDnDc,KAD6B1F,ECoDZ,CACnCwD,QAAS,gBAAGpB,EAAH,EAAGA,IAAH,MAAc,CAAEuD,SAAU,kBAAMvD,GAAI,SAACwD,GAAD,OAAe,IAANA,YDpD1B5F,EAAU,IAC7BF,EAFwBC,ECoDT,IAnCd,GDf2BC,EAAS,CACxCe,OAAQ,IAAIwC,IAAgBxD,GAC5BiB,UAAW,GACXE,cAAe,WAAc,MAAQ,IACrCD,cAAe,WAAc,OAAO,SAAUH,GAAS,OAAOA,OCkDzD+E,EAAQnC,EAAa,CAChCoC,MAAON,OAAOO,WACdlB,OAAQW,OAAOQ,cAGJC,EAAOvC,EAClB,CACEwC,EAAGL,EAAMpE,MAAMqE,MAAQ,EAAI,GAC3BlB,EAAGiB,EAAMpE,MAAMoD,OAAS,EAAI,GAC5BiB,MAAO,GACPjB,OAAQ,GACRsB,KAAMnB,IAAkB,GAAK,EAC7BoB,KAAMrB,GAAgB,EAAG,IAE3B,CACEvB,QAAS,WACP,MAAO,CACL6C,MAAO,WACLX,EAAMnD,QACN0D,EAAKlE,MAAM,CACTmE,EAAGL,EAAMpE,MAAMqE,MAAQ,EAAI,GAC3BlB,EAAGiB,EAAMpE,MAAMoD,OAAS,EAAI,GAC5BsB,KAAMnB,IAAkB,GAAK,EAC7BoB,KAAMrB,GAAgB,EAAG,MAG7BuB,KAAM,WAkBJ,IAjBA,IA7DO5G,EAAS6G,EA6DVC,EAAYd,EAAMjE,MAClBgF,EAAUC,EAAGjF,MACbkF,EAAUC,EAAGnF,MACboF,EAAYZ,EAAKxE,MAJb,EAKyCoE,EAAMpE,MAA1CqF,EALL,EAKFhB,MAA2BiB,EALzB,EAKiBlC,OACnBqB,EAAoCW,EAApCX,EAAGtB,EAAiCiC,EAAjCjC,EAAGuB,EAA8BU,EAA9BV,KAAMC,EAAwBS,EAAxBT,KAEdY,EAAOpC,EAAIwB,EAAOI,EAElBS,EAAY,CAChBf,EAAGA,EAAIC,EAAOK,EACd5B,EAAGoC,EACHZ,KAAMY,EAAO,GAAKA,EAAOD,GAAsB,EAARX,EAAYA,EACnDN,MAR0Ce,EAAlBf,MASxBjB,OAT0CgC,EAAXhC,QAYjC,MAAgB,CAAC4B,EAASE,GAA1B,eAAoC,CAA/B,IAAMjI,EAAC,KAEV,GAhFc6H,EA+EWU,KA/EpBvH,EA+EiBhB,GA7E5BkG,EAAIlF,EAAEmF,OAAS0B,EAAE3B,GACnBlF,EAAEkF,EAAI2B,EAAE3B,EAAI2B,EAAE1B,QACdnF,EAAEwG,EAAIxG,EAAEoG,MAAQS,EAAEL,GAClBxG,EAAEwG,EAAIK,EAAEL,EAAIK,EAAET,OA6EJ,OADAJ,EAAMC,WACCM,EAAKlE,MAAL,2BACFkF,GADE,IAELd,MAAc,EAARA,EACNC,KAAM7B,EAAmB7F,EAAGmI,MAKlC,GAAIX,EAAI,GAAKA,EAAIY,EAGf,OAFIZ,EAAI,GAAGQ,EAAGQ,aACVhB,EAAIY,GAAYF,EAAGM,aAChBjB,EAAKI,QAGdJ,EAAKlE,MAAMkF,QAOfE,EAASzD,EACb,CACEwC,EAAG,EACHtB,EAAG,EACHkB,MAAO,EACPjB,OAAQ,EACRuC,QAAS,EACTC,MAAO,GAET,CACE7D,QAAS,SAAC9E,GAAD,MAAQ,CACf4I,OAAQ5I,EAAEqC,OAAOiB,KACfuF,YAAwB,SACxBvE,aAAI,SAAC4C,GAAD,OAASA,EAAIyB,UAEnBG,OAAQ,kBAAM9I,EAAEqD,MAAM,CAAEqF,SAAU,KAClCK,SAAU,kBAAM/I,EAAEqD,MAAM,CAAEqF,QAAS,KACnCM,SAAU,kBAAMhJ,EAAEqD,MAAM,CAAEqF,QAAS,KACnCF,WAAY,kBACVxI,EAAE0D,KAAI,SAACtB,GAAD,mBAAC,eAAgBA,GAAjB,IAAwBuG,MAAOvG,EAAMuG,MAAQ,QACrDf,KAAM,WAAO,IAAD,EACqB5H,EAAE+C,MAAzB2F,EADE,EACFA,QAASxC,EADP,EACOA,EAAGC,EADV,EACUA,OACdxG,EAAIqH,EAAMjE,MAEhB2F,GACE1I,EAAEqD,MAAM,CACN6C,EACc,IAAZwC,EACI/G,KAAKyE,IAAIe,EAAMpE,MAAMoD,OAASA,EAAQD,EAAIvG,GAC1CgC,KAAKsE,IAAI,EAAGC,EAAIvG,UAOrBqI,EAAKS,EAAO9D,MAAM,CAC7B6C,EAlJoB,IAmJpBtB,EAAGiB,EAAMpE,MAAMoD,OAAS,EAAI,GAC5BiB,MAAO,GACPjB,OAAQ,IACRuC,QAAS,EACTC,MAAO,IAGIT,EAAKO,EAAO9D,MAAM,CAC7B6C,EAAGL,EAAMpE,MAAMqE,MA3JK,IA4JpBlB,EAAGiB,EAAMpE,MAAMoD,OAAS,EAAI,GAC5BiB,MAAO,GACPjB,OAAQ,IACRuC,QAAS,EACTC,MAAO,ICrKT,SAASM,IACP,IAAMC,EAAMC,iBAAiC,MAuC7C,OArCAC,qBAAU,WACR,IAAMC,EAASH,EAAII,QACbC,EAAMF,EAAOG,WAAW,MAsBxBC,EAAa,SAACzJ,GAA8B,IAAD,EACfA,EAAE+C,MAA1ByE,EADuC,EACvCA,EAAGtB,EADoC,EACpCA,EAAGkB,EADiC,EACjCA,MAAOjB,EAD0B,EAC1BA,OACrBoD,EAAIG,SAASlC,EAAGtB,EAAGkB,EAAOjB,IAG5BoB,EAAKlF,OAAOoC,WAAU,YAzBR,WACZ,IAAMkF,EAAaxC,EAAMpE,MACzBsG,EAAOjC,MAAQuC,EAAWvC,MAC1BiC,EAAOlD,OAASwD,EAAWxD,OAC3BoD,EAAIK,UAAU,EAAG,EAAGP,EAAOjC,MAAOiC,EAAOlD,QACzCoD,EAAIM,UAAY,cAqBhBhG,GAlBe,WAAO,IAAD,EACG0D,EAAKxE,MAArByE,EADa,EACbA,EAAGtB,EADU,EACVA,EACL4D,EAFe,EACP1C,MACO,EACjB2C,EAAUvC,EAAIsC,EACdE,EAAU9D,EAAI4D,EACdG,EAASH,EAEbP,EAAIW,YACJX,EAAIY,IAAIJ,EAASC,EAASC,EAAQ,EAAG,EAAItI,KAAKyI,IAAI,GAClDb,EAAIc,OAUJC,GACAb,EAAWzB,GACXyB,EAAWvB,QAEZ,IAEI,4BAAQqC,UAAU,SAASrB,IAAKA,IAGzC,SAASsB,IACP,IAAMzC,EAAU9C,EAAM+C,EAAGY,QACnBX,EAAUhD,EAAMiD,EAAGU,QAEzB,OACE,yBAAK2B,UAAU,UACb,yBAAKA,UAAU,SAASxC,GACxB,yBAAKwC,UAAU,SAAStC,IAKfwC,MAhEf,WACE,OACE,yBAAKF,UAAU,SACb,kBAACC,EAAD,MACA,kBAACvB,EAAD,QCON,SAASyB,EAAT,GAA8D,IACtDjC,EAASxD,EAD4C,EAA3C7C,MACWC,QAE3B,OACE,yBACEkI,UAAU,SACVI,MAAO,CAAEC,UAAU,aAAD,OAAenC,EAAOjB,EAAtB,eAA8BiB,EAAOvC,EAArC,UAKxB,SAAS2E,IACP,IAAM1C,EAAYlD,EAAMsC,EAAKlF,QAE7B,OACE,yBACEkI,UAAU,OACVI,MAAO,CAAEC,UAAU,aAAD,OAAezC,EAAUX,EAAzB,eAAiCW,EAAUjC,EAA3C,UAKxB,SAASsE,KACP,IAAMzC,EAAU9C,EAAM+C,EAAGY,QACnBX,EAAUhD,EAAMiD,EAAGU,QAEzB,OACE,yBAAK2B,UAAU,UACb,yBAAKA,UAAU,SAASxC,GACxB,yBAAKwC,UAAU,SAAStC,IAKfwC,OA7Cf,WACE,OACE,yBAAKF,UAAU,SACb,kBAAC,GAAD,MACA,kBAACG,EAAD,CAAQtI,MAAO4F,IACf,kBAAC0C,EAAD,CAAQtI,MAAO8F,IACf,kBAAC2C,EAAD,QCcSC,OAnBf,WAAgB,IAAD,EACmBzF,mBAA4B,QAD/C,mBACN0F,EADM,KACIC,EADJ,KAMb,OAHA5B,qBAAU,YH6KY,WAEtB,IAAM6B,EAAU1E,EACbjD,KACC4H,aAAI,WACF3D,EAAKK,OACLI,EAAGJ,OACHM,EAAGN,WAGNnD,YAGG0G,EAAS1E,EACZnD,KACCgB,aAAI,SAAC8G,GAAD,OAASA,EAAIC,SACjB/G,aAAI,SAACgH,GACH,IAAM7C,EAAS,CAAC,GAAI,IAAI8C,SAASD,GAAWpD,EAAKF,EAEjD,OAAQsD,GACN,KAAK,GACL,KAAK,GACH7C,EAAOK,SACP,MACF,KAAK,GACL,KAAK,GACHL,EAAOM,WAGX,OAAON,KAET+C,aAAU,SAAC/C,GAAD,OAAY7B,EAAOtD,KAAK4H,aAAI,kBAAMzC,EAAOO,mBAEpDvE,YAGGgH,EAAY5E,EAAcpC,WAAU,WACxC0C,EAAMzD,IAAI,CACR0D,MAAON,OAAOO,WACdlB,OAAQW,OAAOQ,cAGjBY,EAAG7E,MAAM,CAAEmE,EAAGL,EAAMpE,MAAMqE,MA7MR,SGTlBsE,KACC,IAED,oCACE,4BACEf,MAAO,CAAEgB,OAAQ,EAAGC,SAAU,YAC9BC,QAAS,kBAAMb,EAAyB,WAAbD,EAAwB,OAAS,YAF9D,UAMc,WAAbA,EAAwB,kBAAC,EAAD,MAAiB,kBAAC,GAAD,QCP5Be,QACW,cAA7BhF,OAAOiF,SAASC,UAEe,UAA7BlF,OAAOiF,SAASC,UAEhBlF,OAAOiF,SAASC,SAASC,MACvB,2DCZNC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,GAAD,OAEFzF,SAAS0F,eAAe,SDiIpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrBC,MAAK,SAAAC,GACJA,EAAaC,gBAEdC,OAAM,SAAAC,GACLC,QAAQD,MAAMA,EAAME,c","file":"static/js/main.e493b118.chunk.js","sourcesContent":["export var genRandomString = function () {\n    return Math.random().toString(36).substring(2, 10);\n};\nexport var defaultGenId = function () {\n    return ([1e7].toString() + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, function (c) {\n        return (c ^\n            (window.crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))).toString(16);\n    });\n};\nexport var ensureArray = function (items) {\n    return Array.isArray(items) ? items : [items];\n};\nexport var createConstant = function (name, constant) {\n    return name + \"/\" + constant;\n};\nexport var createConstants = function (name, constants) {\n    return constants.reduce(function (acc, constant) {\n        acc[constant] = createConstant(name, constant);\n        return acc;\n    }, {});\n};\nexport var wrapDispatchSubject = function (dispatch$) { return function (action) {\n    dispatch$.next(action);\n    return action;\n}; };\nexport var getType = function (action) {\n    return action.type.split('/', 2).join('/');\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { BehaviorSubject, Subject, merge } from 'rxjs';\nimport { genRandomString, createConstants, wrapDispatchSubject } from './utils';\nimport { distinctUntilChanged, map, mergeMap } from 'rxjs/operators';\nvar DEFAULT_CONSTANTS = ['SET', 'RESET'];\nvar createBaseActions = function (_a) {\n    var constant = _a.constant, get = _a.get;\n    var dispatch$ = new Subject();\n    var _dispatchers$ = new Subject();\n    var action$ = merge(dispatch$, _dispatchers$.pipe(mergeMap(function (obs$) { return obs$; })));\n    var dispatch = wrapDispatchSubject(dispatch$);\n    return {\n        action$: action$,\n        set: function (data) {\n            // @ts-ignore\n            data = typeof data === 'function' ? data(get()) : data;\n            return dispatch({ type: constant.SET, data: data });\n        },\n        reset: function () { return dispatch({ type: constant.RESET }); },\n        dispatch: dispatch,\n        _dispatchers$: _dispatchers$\n    };\n};\nvar createBaseReducer = function (_a) {\n    var initialState = _a.initialState, constant = _a.constant, reducer = _a.reducer, userReducer = _a.userReducer;\n    return function (state, action) {\n        var type = action.type.split('/', 2).join('/');\n        switch (type) {\n            case constant.SET:\n                return action.data;\n            case constant.RESET:\n                return initialState;\n            default:\n                var res = reducer(state, action);\n                // if the result is the same as our initial state\n                // pass it on to the user reducer\n                return res === state ? userReducer(state, action) : res;\n        }\n    };\n};\nexport var createStateRx = function (initialState, options, overrides) {\n    var _a;\n    var _b = options.name, name = _b === void 0 ? genRandomString() : _b, _c = options.autoRun, autoRun = _c === void 0 ? true : _c, _d = options.reducer, userReducer = _d === void 0 ? function (state) { return state; } : _d;\n    var state$ = overrides.state$, constants = overrides.constants, createReducer = overrides.createReducer, createActions = overrides.createActions, createSelectors = overrides.createSelectors;\n    var constant = createConstants(name, __spreadArrays(DEFAULT_CONSTANTS, constants));\n    var get = function () { return state$.getValue(); };\n    var _e = createBaseActions({\n        constant: constant,\n        get: get\n    }), action$ = _e.action$, dispatch = _e.dispatch, baseActions = __rest(_e, [\"action$\", \"dispatch\"]);\n    var actions = __rest(createActions({\n        constant: constant,\n        get: get,\n        dispatch: dispatch\n    }), []);\n    var selectors = createSelectors === null || createSelectors === void 0 ? void 0 : createSelectors(state$);\n    var reducer = createBaseReducer({\n        constant: constant,\n        initialState: initialState,\n        reducer: createReducer({\n            constant: constant\n        }),\n        userReducer: userReducer\n    });\n    var clone = function (newInitialState) {\n        if (newInitialState === void 0) { newInitialState = get(); }\n        return createStateRx(newInitialState, options, __assign(__assign({}, overrides), { state$: new BehaviorSubject(newInitialState) }));\n    };\n    var _reducer$ = action$.pipe(map(function (action) { return reducer(state$.getValue(), action); }), distinctUntilChanged());\n    var run = function () { return _reducer$.subscribe(state$); };\n    var api = __assign(__assign(__assign(__assign({}, actions), selectors), baseActions), { name: name,\n        state$: state$,\n        action$: action$,\n        constant: constant,\n        run: run,\n        get: get,\n        clone: clone,\n        dispatch: dispatch,\n        _reducer$: _reducer$ });\n    var effects = (_a = options.effects) === null || _a === void 0 ? void 0 : _a.call(options, api);\n    autoRun && run();\n    return __assign(__assign({}, api), effects);\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { BehaviorSubject } from 'rxjs';\nimport { getType } from './utils';\nimport { createStateRx } from './create-staterx';\nvar createActions = function (_a) {\n    var constant = _a.constant, dispatch = _a.dispatch;\n    return {\n        merge: function (data) { return dispatch({ type: constant.MERGE, data: data }); }\n    };\n};\nvar createReducer = function (_a) {\n    var constant = _a.constant;\n    return function (state, action) {\n        var type = getType(action);\n        switch (type) {\n            case constant.MERGE:\n                return __assign(__assign({}, state), action.data);\n            default:\n                return state;\n        }\n    };\n};\nexport var createObject = function (initialState, options) {\n    if (options === void 0) { options = {}; }\n    return createStateRx(initialState, options, {\n        state$: new BehaviorSubject(initialState),\n        constants: ['MERGE'],\n        createActions: createActions,\n        createReducer: createReducer\n    });\n};\n","import { useState, useLayoutEffect, useMemo } from 'react';\nexport function useRx(obsInput$, deps) {\n    var obs$ = useMemo(function () { return (typeof obsInput$ === 'function' ? obsInput$() : obsInput$); }, deps);\n    var _a = useState(\n    // @ts-ignore\n    'getValue' in obs$ ? obs$.getValue() : undefined), value = _a[0], setValue = _a[1];\n    // subscribe to observable\n    useLayoutEffect(function () {\n        var sub = obs$.subscribe(setValue, function (err) {\n            setValue(function () {\n                throw err;\n            });\n        });\n        return function () {\n            sub.unsubscribe();\n        };\n    }, [obs$]);\n    return value;\n}\n","import { BehaviorSubject } from 'rxjs';\nimport { createStateRx } from './create-staterx';\nexport var createValue = function (initialState, options) {\n    if (options === void 0) { options = {}; }\n    return createStateRx(initialState, options, {\n        state$: new BehaviorSubject(initialState),\n        constants: [],\n        createActions: function () { return ({}); },\n        createReducer: function () { return function (state) { return state; }; }\n    });\n};\n","import { createObject, createValue } from 'staterx';\nimport { interval, fromEvent } from 'rxjs';\nimport {\n  tap,\n  switchMap,\n  debounceTime,\n  map,\n  distinctUntilKeyChanged\n} from 'rxjs/operators';\n\n/**************************************************\n * Types\n **************************************************/\ntype Rect = { width: number; height: number; x: number; y: number };\n\n/**************************************************\n * Constants\n **************************************************/\nconst PADDLE_MARGIN = 128;\nconst FPS = 60;\n\n/**************************************************\n * Utils\n **************************************************/\nconst hittest = (a: Rect, b: Rect) =>\n  !(\n    a.y + a.height < b.y ||\n    a.y > b.y + b.height ||\n    a.x + a.width < b.x ||\n    a.x > b.x + b.width\n  );\n\nconst getDeflectionAngle = (r1: Rect, r2: Rect) => {\n  const diff = Math.max(0, r2.y - r1.y - r2.height + r2.height / 2) * 2;\n  const dir = diff / r1.height - 1;\n  return Math.max(-1, Math.min(1, dir));\n};\n\nconst getRandomFloat = (min: number, max: number) =>\n  Math.random() * (max - min) + min;\n\nconst getRandomBool = () => Math.random() >= 0.5;\n\n/**************************************************\n * Observables\n **************************************************/\nconst loop$ = interval((1 / FPS) * 1000);\nconst keyDown$ = fromEvent<KeyboardEvent>(document, 'keydown');\nconst keyUp$ = fromEvent<KeyboardEvent>(document, 'keyup');\nconst windowResize$ = fromEvent(window, 'resize').pipe(debounceTime(200));\n\n/**************************************************\n * States\n **************************************************/\nconst speed = createValue(500 / FPS, {\n  effects: ({ set }) => ({ increase: () => set((val) => val * 1.1) })\n});\n\nexport const board = createObject({\n  width: window.innerWidth,\n  height: window.innerHeight\n});\n\nexport const ball = createObject(\n  {\n    x: board.get().width / 2 - 16,\n    y: board.get().height / 2 - 16,\n    width: 32,\n    height: 32,\n    dirX: getRandomBool() ? 1 : -1,\n    dirY: getRandomFloat(-1, 1)\n  },\n  {\n    effects: () => {\n      return {\n        serve: () => {\n          speed.reset();\n          ball.merge({\n            x: board.get().width / 2 - 16,\n            y: board.get().height / 2 - 16,\n            dirX: getRandomBool() ? 1 : -1,\n            dirY: getRandomFloat(-1, 1)\n          });\n        },\n        tick: () => {\n          const currSpeed = speed.get();\n          const p1State = p1.get();\n          const p2State = p2.get();\n          const ballState = ball.get();\n          const { width: boardWidth, height: boardHeight } = board.get();\n          const { x, y, dirX, dirY, width, height } = ballState;\n\n          const newY = y + dirY * currSpeed;\n\n          const newBounds = {\n            x: x + dirX * currSpeed,\n            y: newY,\n            dirY: newY < 0 || newY > boardHeight ? dirY * -1 : dirY,\n            width,\n            height\n          };\n\n          for (const p of [p1State, p2State]) {\n            const isHit = hittest(p, newBounds);\n            if (isHit) {\n              speed.increase();\n              return ball.merge({\n                ...newBounds,\n                dirX: dirX * -1,\n                dirY: getDeflectionAngle(p, ballState)\n              });\n            }\n          }\n\n          if (x < 0 || x > boardWidth) {\n            if (x < 0) p1.scorePoint();\n            if (x > boardWidth) p2.scorePoint();\n            return ball.serve();\n          }\n\n          ball.merge(newBounds);\n        }\n      };\n    }\n  }\n);\n\nconst player = createObject(\n  {\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0,\n    moveDir: 0,\n    score: 0\n  },\n  {\n    effects: (p) => ({\n      score$: p.state$.pipe(\n        distinctUntilKeyChanged('score'),\n        map((val) => val.score)\n      ),\n      moveUp: () => p.merge({ moveDir: -1 }),\n      moveDown: () => p.merge({ moveDir: 1 }),\n      stopMove: () => p.merge({ moveDir: 0 }),\n      scorePoint: () =>\n        p.set((state) => ({ ...state, score: state.score + 1 })),\n      tick: () => {\n        const { moveDir, y, height } = p.get();\n        const s = speed.get();\n\n        moveDir &&\n          p.merge({\n            y:\n              moveDir === 1\n                ? Math.min(board.get().height - height, y + s)\n                : Math.max(0, y - s)\n          });\n      }\n    })\n  }\n);\n\nexport const p1 = player.clone({\n  x: PADDLE_MARGIN,\n  y: board.get().height / 2 - 64,\n  width: 16,\n  height: 128,\n  moveDir: 0,\n  score: 0\n});\n\nexport const p2 = player.clone({\n  x: board.get().width - PADDLE_MARGIN,\n  y: board.get().height / 2 - 64,\n  width: 16,\n  height: 128,\n  moveDir: 0,\n  score: 0\n});\n\nexport const initGame = () => {\n  // Handle the game loop\n  const loopSub = loop$\n    .pipe(\n      tap(() => {\n        ball.tick();\n        p1.tick();\n        p2.tick();\n      })\n    )\n    .subscribe();\n\n  // Bind player controls\n  const keySub = keyDown$\n    .pipe(\n      map((evt) => evt.which),\n      map((keycode) => {\n        const player = [38, 40].includes(keycode) ? p2 : p1;\n\n        switch (keycode) {\n          case 38:\n          case 87:\n            player.moveUp();\n            break;\n          case 40:\n          case 83:\n            player.moveDown();\n            break;\n        }\n        return player;\n      }),\n      switchMap((player) => keyUp$.pipe(tap(() => player.stopMove())))\n    )\n    .subscribe();\n\n  // Handle window resizing\n  const windowSub = windowResize$.subscribe(() => {\n    board.set({\n      width: window.innerWidth,\n      height: window.innerHeight\n    });\n\n    p2.merge({ x: board.get().width - PADDLE_MARGIN });\n  });\n\n  return () => [loopSub, keySub, windowSub].map((sub) => sub.unsubscribe());\n};\n","import React, { useEffect, useRef } from 'react';\nimport { useRx } from 'staterx';\nimport { ball, p1, p2, board } from './state';\n\nfunction Game() {\n  return (\n    <div className=\"board\">\n      <Score />\n      <Canvas />\n    </div>\n  );\n}\n\nfunction Canvas() {\n  const ref = useRef<HTMLCanvasElement | null>(null);\n\n  useEffect(() => {\n    const canvas = ref.current!;\n    const ctx = canvas.getContext('2d')!;\n\n    const reset = () => {\n      const boardState = board.get();\n      canvas.width = boardState.width;\n      canvas.height = boardState.height;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.fillStyle = 'greenyellow';\n    };\n\n    const drawBall = () => {\n      const { x, y, width } = ball.get();\n      const half = width / 2;\n      var centerX = x + half;\n      var centerY = y + half;\n      var radius = half;\n\n      ctx.beginPath();\n      ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI, false);\n      ctx.fill();\n    };\n\n    const drawPlayer = (p: typeof p1 | typeof p2) => {\n      const { x, y, width, height } = p.get();\n      ctx.fillRect(x, y, width, height);\n    };\n\n    ball.state$.subscribe(() => {\n      reset();\n      drawBall();\n      drawPlayer(p1);\n      drawPlayer(p2);\n    });\n  }, []);\n\n  return <canvas className=\"canvas\" ref={ref} />;\n}\n\nfunction Score() {\n  const p1State = useRx(p1.score$);\n  const p2State = useRx(p2.score$);\n\n  return (\n    <div className=\"scores\">\n      <div className=\"score\">{p1State}</div>\n      <div className=\"score\">{p2State}</div>\n    </div>\n  );\n}\n\nexport default Game;\n","import React from 'react';\nimport { useRx } from 'staterx';\nimport { ball, p1, p2 } from './state';\n\nfunction Game() {\n  return (\n    <div className=\"board\">\n      <Score />\n      <Paddle state={p1} />\n      <Paddle state={p2} />\n      <Ball />\n    </div>\n  );\n}\n\nfunction Paddle({ state }: { state: typeof p1 | typeof p2 }) {\n  const player = useRx(state.state$);\n\n  return (\n    <div\n      className=\"paddle\"\n      style={{ transform: `translate(${player.x}px, ${player.y}px)` }}\n    />\n  );\n}\n\nfunction Ball() {\n  const ballState = useRx(ball.state$);\n\n  return (\n    <div\n      className=\"ball\"\n      style={{ transform: `translate(${ballState.x}px, ${ballState.y}px)` }}\n    />\n  );\n}\n\nfunction Score() {\n  const p1State = useRx(p1.score$);\n  const p2State = useRx(p2.score$);\n\n  return (\n    <div className=\"scores\">\n      <div className=\"score\">{p1State}</div>\n      <div className=\"score\">{p2State}</div>\n    </div>\n  );\n}\n\nexport default Game;\n","import React, { useEffect, useState } from 'react';\nimport CanvasGame from './game-canvas';\nimport HTMLGame from './game-html';\nimport { initGame } from './state';\n\nfunction App() {\n  const [renderer, setRenderer] = useState<'html' | 'canvas'>('html');\n\n  useEffect(() => {\n    initGame();\n  }, []);\n  return (\n    <>\n      <button\n        style={{ zIndex: 9, position: 'absolute' }}\n        onClick={() => setRenderer(renderer === 'canvas' ? 'html' : 'canvas')}\n      >\n        Toggle\n      </button>\n      {renderer === 'canvas' ? <CanvasGame /> : <HTMLGame />}\n    </>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './app';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}