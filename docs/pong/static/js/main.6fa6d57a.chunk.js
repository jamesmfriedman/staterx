(this["webpackJsonpstaterx-pong"]=this["webpackJsonpstaterx-pong"]||[]).push([[0],{36:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var r=("undefined"!==typeof globalThis?globalThis:"undefined"!==typeof e?e:"undefined"!==typeof window?window:void 0).StateRx={objects:{}},a=function(e){r.objects[e.key]=e}}).call(this,n(46))},40:function(e,t,n){e.exports=n(47)},45:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(34),i=n.n(c),o=(n(45),n(38)),u=n(39),s=n(51),f=n(56),l=n(50),d=n(35),h=(n(52),function(){return Math.random().toString(36).substring(2,10)}),v=function(e){return function(t){return e.next(t),t}},g=function(e){return e.type.split("/",2).join("/")},m=n(37),p=n(36),b=function(){return(b=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},y=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},w=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var c=arguments[t],i=0,o=c.length;i<o;i++,a++)r[a]=c[i];return r},O=["SET","RESET"],E=function e(t,n){var r,a=t.default,c=t.key,i=void 0===c?h():c,o=t.autoRun,g=void 0===o||o,E=t.reducer,j=void 0===E?function(e){return e}:E,x=n.state$,k=n.constants,$=n.createReducer,S=n.createActions,M=n.createSelectors,R=function(e,t){return t.reduce((function(t,n){return t[n]=function(e,t){return e+"/"+t}(e,n),t}),{})}(i,w(O,k)),N=function(){return x.getValue()},P=function(e){var t=e.constant,n=e.get,r=new u.a,a=new u.a,c=Object(f.a)(r,a.pipe(Object(m.a)((function(e){return e})))),i=v(r);return{action$:c,set:function(e){return e="function"===typeof e?e(n()):e,i({type:t.SET,data:e})},reset:function(){return i({type:t.RESET})},dispatch:i,_dispatchers$:a}}({constant:R,get:N}),D=P.action$,T=P.dispatch,Y=y(P,["action$","dispatch"]),A=y(S({constant:R,get:N,dispatch:T}),[]),I=null===M||void 0===M?void 0:M(x),V=function(e){var t=e.initialState,n=e.constant,r=e.reducer,a=e.userReducer;return function(e,c){switch(c.type.split("/",2).join("/")){case n.SET:return c.data;case n.RESET:return t;default:var i=r(e,c);return i===e?a(e,c):i}}}({constant:R,initialState:a,reducer:$({constant:R}),userReducer:j}),W=D.pipe(Object(d.a)((function(e){return V(x.getValue(),e)})),Object(l.a)()),X=function(){return W.subscribe(x)},G=b(b(b(b({},A),I),Y),{key:i,state$:x,action$:D,constant:R,run:X,get:N,clone:function(r){var a=void 0!==(null===r||void 0===r?void 0:r.default)?r.default:N();return e(b(b(b({},t),{key:h(),default:a}),r),b(b({},n),{state$:new s.a(a)}))},dispatch:T,toJSON:function(){return N()},_reducer$:W}),J=null===(r=t.effects)||void 0===r?void 0:r.call(t,G);g&&X();var z=b(b({},G),J);return Object(p.a)(z),z},j=function(){return(j=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},x=function(e){var t=e.constant,n=e.dispatch;return{merge:function(e){return n({type:t.MERGE,data:e})}}},k=function(e){var t=e.constant;return function(e,n){switch(g(n)){case t.MERGE:return j(j({},e),n.data);default:return e}}},$=function(e){return void 0===e&&(e={}),E(e,{state$:new s.a(e.default||{}),constants:["MERGE"],createActions:x,createReducer:k})};function S(e,t){var n=Object(r.useMemo)((function(){return"function"===typeof e?e():e}),t),a=Object(r.useState)("getValue"in n?n.getValue():void 0),c=a[0],i=a[1];return Object(r.useLayoutEffect)((function(){var e=n.subscribe(i,(function(e){i((function(){throw e}))}));return function(){e.unsubscribe()}}),[n]),c}var M,R=n(25),N=n(57),P=n(53),D=n(54),T=n(58),Y=n(32),A=n(59),I=n(55),V=function(e,t){var n=2*Math.max(0,t.y-e.y-t.height+t.height/2)/e.height-1;return Math.max(-1,Math.min(1,n))},W=function(e,t){return Math.random()*(t-e)+e},X=function(){return Math.random()>=.5},G=Object(N.a)(1/60*1e3),J=Object(P.a)(document,"keydown"),z=Object(P.a)(document,"keyup"),B=Object(P.a)(window,"resize").pipe(Object(D.a)(200)),C=(void 0===(M={key:"speed",default:500/60,effects:function(e){var t=e.set;return{increase:function(){return t((function(e){return 1.1*e}))}}}})&&(M={}),E(M,{state$:new s.a(M.default),constants:[],createActions:function(){return{}},createReducer:function(){return function(e){return e}}})),H=$({key:"board",default:{width:window.innerWidth,height:window.innerHeight}}),U=$({key:"ball",default:{x:H.get().width/2-16,y:H.get().height/2-16,width:32,height:32,dirX:X()?1:-1,dirY:W(-1,1)},effects:function(){return{serve:function(){C.reset(),U.merge({x:H.get().width/2-16,y:H.get().height/2-16,dirX:X()?1:-1,dirY:W(-1,1)})},tick:function(){for(var e,t,n=C.get(),r=F.get(),a=L.get(),c=U.get(),i=H.get(),o=i.width,u=i.height,s=c.x,f=c.y,l=c.dirX,d=c.dirY,h=f+d*n,v={x:s+l*n,y:h,dirY:h<0||h>u?-1*d:d,width:c.width,height:c.height},g=0,m=[r,a];g<m.length;g++){var p=m[g];if(t=v,!((e=p).y+e.height<t.y||e.y>t.y+t.height||e.x+e.width<t.x||e.x>t.x+t.width))return C.increase(),U.merge(Object(R.a)(Object(R.a)({},v),{},{dirX:-1*l,dirY:V(p,c)}))}if(s<0||s>o)return s<0&&F.scorePoint(),s>o&&L.scorePoint(),U.serve();U.merge(v)}}}}),_=$({default:{x:0,y:0,width:0,height:0,moveDir:0,score:0},effects:function(e){return{score$:e.state$.pipe(Object(T.a)("score"),Object(Y.a)((function(e){return e.score}))),moveUp:function(){return e.merge({moveDir:-1})},moveDown:function(){return e.merge({moveDir:1})},stopMove:function(){return e.merge({moveDir:0})},scorePoint:function(){return e.set((function(e){return Object(R.a)(Object(R.a)({},e),{},{score:e.score+1})}))},tick:function(){var t=e.get(),n=t.moveDir,r=t.y,a=t.height,c=C.get();n&&e.merge({y:1===n?Math.min(H.get().height-a,r+c):Math.max(0,r-c)})}}}}),F=_.clone({key:"p1",default:{x:128,y:H.get().height/2-64,width:16,height:128,moveDir:0,score:0}}),L=_.clone({key:"p2",default:{x:H.get().width-128,y:H.get().height/2-64,width:16,height:128,moveDir:0,score:0}});function q(){var e=Object(r.useRef)(null);return Object(r.useEffect)((function(){var t=e.current,n=t.getContext("2d"),r=function(e){var t=e.get(),r=t.x,a=t.y,c=t.width,i=t.height;n.fillRect(r,a,c,i)};U.state$.subscribe((function(){!function(){var e=H.get();t.width=e.width,t.height=e.height,n.clearRect(0,0,t.width,t.height),n.fillStyle="greenyellow"}(),function(){var e=U.get(),t=e.x,r=e.y,a=e.width/2,c=t+a,i=r+a,o=a;n.beginPath(),n.arc(c,i,o,0,2*Math.PI,!1),n.fill()}(),r(F),r(L)}))}),[]),a.a.createElement("canvas",{className:"canvas",ref:e})}function K(){var e=S(F.score$),t=S(L.score$);return a.a.createElement("div",{className:"scores"},a.a.createElement("div",{className:"score"},e),a.a.createElement("div",{className:"score"},t))}var Q=function(){return a.a.createElement("div",{className:"board"},a.a.createElement(K,null),a.a.createElement(q,null))};function Z(e){var t=S(e.state.state$);return a.a.createElement("div",{className:"paddle",style:{transform:"translate(".concat(t.x,"px, ").concat(t.y,"px)")}})}function ee(){var e=S(U.state$);return a.a.createElement("div",{className:"ball",style:{transform:"translate(".concat(e.x,"px, ").concat(e.y,"px)")}})}function te(){var e=S(F.score$),t=S(L.score$);return a.a.createElement("div",{className:"scores"},a.a.createElement("div",{className:"score"},e),a.a.createElement("div",{className:"score"},t))}var ne=function(){return a.a.createElement("div",{className:"board"},a.a.createElement(te,null),a.a.createElement(Z,{state:F}),a.a.createElement(Z,{state:L}),a.a.createElement(ee,null))};var re=function(){var e=Object(r.useState)("html"),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){!function(){var e=G.pipe(Object(A.a)((function(){U.tick(),F.tick(),L.tick()}))).subscribe(),t=J.pipe(Object(Y.a)((function(e){return e.which})),Object(Y.a)((function(e){var t=[38,40].includes(e)?L:F;switch(e){case 38:case 87:t.moveUp();break;case 40:case 83:t.moveDown()}return t})),Object(I.a)((function(e){return z.pipe(Object(A.a)((function(){return e.stopMove()})))}))).subscribe(),n=B.subscribe((function(){H.set({width:window.innerWidth,height:window.innerHeight}),L.merge({x:H.get().width-128})}))}()}),[]),a.a.createElement(a.a.Fragment,null,a.a.createElement("button",{style:{zIndex:9,position:"absolute"},onClick:function(){return c("canvas"===n?"html":"canvas")}},"Toggle"),"canvas"===n?a.a.createElement(Q,null):a.a.createElement(ne,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(re,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[40,1,2]]]);
//# sourceMappingURL=main.6fa6d57a.chunk.js.map